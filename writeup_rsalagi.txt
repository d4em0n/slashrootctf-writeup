

~ rsalagi ~ Crypto ~ SlashRootCTF (200pts) 

Kali ini soal crypto berjudul rsalagi, diberikan file archive jjka diesktrak
akan menghasilkan 2 buah file, yaitu pub.key (public keynya) dan flag.enc
(data yang dienkripsi). Untuk mendekripsinya kita harus tau private keynya
saya menggunakan tool RsaCtfTool untuk mencari privetekeynya

----------------------------------------------------------------------------------
ramdhan@n0psledbyt3:~/Downloads/RsaCtfTool-master$ ./RsaCtfTool.py --publickey \
../../slashroot/pub.key --private

-----BEGIN RSA PRIVATE KEY-----
MIIC0AIBAAJ/I8znFVo3AOzh2Wso92yhiaTT0DhtcG0S8OmJoOvKfYrTimG4x8Bz
cSvxyYRoW6SQ5tja8DIU64lN0geKn7NOJ6eGobFpJNYT2IppvuFGhAj1Nqhk4XaE
s28P1kD9N9/6MOZw6HBUKpQ6hDP+tv1EwDF09MecP0kkkUkzMJqDGQJ/IWZMM2GZ
UpsIwRzyvZekFl0xa0vWPDui+xb1ILKkQzWV3erOao1ok950Zk+B45grXvrDXYuT
ltyTStfjt4tzW8bmwNGdOekUARAatqUEtT8m7tvt57Wlwoyp2+sDoJzy5kDQ84DG
lxaZlOs+oErS5dQYlbwN4UovoWGpliGvqQJ/CABZec6lE222w1W9PomrNtywpqLD
Mf3suk+JJArg8mEPwCix0JkLlBRQhHLez9+I3XTkSY38T9ey8SfhtJ5K3lTfX2/N
I7gPWDuHOE4yovz+qXc+W7Tj2/pYSgYdlVPeixpM/og6/eiDZjXOTqWzyyx+aD73
/6/M46OnOoMPHQJABfu8aJCCbai9G/yS0y2CfnpwgPqHE8fxL647Z9TSDylnNELJ
4vZqQXY40UOaaXbDhkBTNMfxpnQloV+tQKV/9wJABfu8aJCCbai9G/yS0y2Cfnpw
gPqHE8fxL647Z9TSDylnNELJ4vZqQXY4yqvZVezoYqFOWeJBC3/Kol5r4IRxbwJA
BH22ll0sv/F1LAlzkEjr1qrIcktk4fHZ7EBusUsecvb7M5RhynMLg1Ader+331vu
Fc/TDkWIsdaGFkUkwkOJ8wJAAdtH0t+MfzyANdpAfSlGfD1GzOXztlonGVX1XwjN
XXVVLD88IS4kidt370ytG2TOuzFuJ8u7Kgv0QlJN09m6jwJAAdWwMzEv1eycGGn6
q0e5GrNxhKQmcbZE8eEHIYnfwsOy/J8L8iqbvS0Er3RfYpqIriM0QyyR1M4iH1tH
xomQ5A==
-----END RSA PRIVATE KEY-----
ramdhan@n0psledbyt3:~/Downloads/RsaCtfTool-master$ ./RsaCtfTool.py --publickey \
../../slashroot/pub.key --private > priv.key
----------------------------------------------------------------------------------

Sekarang kita dumpkey untuk mendapatkan d dan n nya

-------------------------------------------------------------------------------------------------
ramdhan@n0psledbyt3:~/Downloads/RsaCtfTool-master$ ./RsaCtfTool.py --dumpkey --key priv.key
[*] n: 982027209445986198779376967661415531544489336632283712011011849035879532687065788047054362
2825402145885551826093722613785741600936163978405380091236126814868256943652047346581726899879824
9065101477123034780839989162119600350004703163744826330712410064895092311117788014715059702456632
425601696051570049817
[*] e: 916171753563979788681860349490480909763328853915205995988398171099886440846335067904198892
9878240712681831609290131867348060293182646050790762625159091265484531606120037417359381472783600
5153071825633867112370454354236598400802139368287421713129721132575144408256541038758578654094233
103968476295778643881
[*] d: 219482413572023673535862483466949879245769406179702417674384125093870094428980740445357530
1784891639888014086169047212845386436076040899873436967747829344564615368967418811774279587448207
0577648345582394102585455750295951225122191516869259351663821416236438847078021918332073480649712
977543207594271903517
[*] p: 313373133731337313373133731337313373133731337313373133731337313373133731337313373133731337
313373133734567890101010101010101010101010101010101010101010423
[*] q: 313373133731337313373133731337313373133731337313373133731337313373133731337313373133731337
313373133732101234567890987654321012345678909876543210123456879
-------------------------------------------------------------------------------------------------

Nah kita udah dapat n dan d nya mari kita dekrip flag.enc nya. Karena flag.enc berisi base64.
kita decode dulu

----------------------------------------------------------------------------------------------------
ramdhan@n0psledbyt3:~/slashroot$ cat flag.enc 
OTA5MTUxOTY0NTk0NTE3MjE2MDU3MDI2OTMwMzgyMTk0MDk2MDkwMDc2ODQxODc5NTEwMDI4NTk2
Nzg5ODU0NDAxOTE2ODk3NTcxNDUyMDg2NDUzODgyOTYyMzY0OTY2NTc5MzIyNzI1ODM2NDk3NzA0
NTMzMDEzMTMxODY5NDg1Mjg3MzI1NTI3MDMzNjQzNzMzODkwMDkwNjMyNzA3NzkyMDM1ODk2ODIx
NTUzMjM0MTU1OTUzMTYwNTI4NDUyODg1OTM5NTc4NzE2NzkwODgxNzcyMzEwOTA2ODczMzU3NDE0
OTk1MDMxMzQyODUxNjM4MjkxOTgxMDc0NjAyMDA3OTAxNzU5MTc2NTg5NDg2MDEzOTI1ODI3MTIw
OTI5OTAwNjA2NjE1MjgzODE2NjE=
ramdhan@n0psledbyt3:~/slashroot$ cat flag.enc | base64 -d
909151964594517216057026930382194096090076841879510028596789854401916897571452086453882962364966579
322725836497704533013131869485287325527033643733890090632707792035896821553234155953160528452885939
578716790881772310906873357414995031342851638291981074602007901759176589486013925827120929900606615
28381661
-----------------------------------------------------------------------------------------------------

Angka diatas akan dimasukkan kevariable d, sekarang kita buka python, masukkan variable c,d dan n
beserta isinya.

ramdhan@n0psledbyt3:~/slashroot$ python
Python 2.7.13 (default, Jan 19 2017, 14:48:08) 
[GCC 6.3.0 20170118] on linux2
Type "help", "copyright", "credits" or "license" for more information.
>>> n=982027209445986198779376967661415531544489336632283712011011849035879532687065788047054362282540
214588555182609372261378574160093616397840538009123612681486825694365204734658172689987982490651014771
230347808399891621196003500047031637448263307124100648950923111177880147150597024566324256016960515700
49817
>>> d=2194824135720236735358624834669498792457694061797024176743841250938700944289807404453575301784891
6398880140861690472128453864360760408998734369677478293445646153689674188117742795874482070577648345582
3941025854557502959512251221915168692593516638214162364388470780219183320734806497129775432075942719035
17
>>> c=9091519645945172160570269303821940960900768418795100285967898544019168975714520864538829623649665
7932272583649770453301313186948528732552703364373389009063270779203589682155323415595316052845288593957
8716790881772310906873357414995031342851638291981074602007901759176589486013925827120929900606615283816
61
>>> hasil_dekrip = pow(c,d,n)
>>> hex(hasil_dekrip)
'0x546572696d61206b6173696820726f6e205269766573742c20616469205368616d69722064616e206c656e2041646c656d61
6e2e0a536c617368526f6f744354467b7273615f5253415f313235345f5269766573742d5368616d69722d41646c656d616e7dL'
--------------------------------------------------------------------------------------------------------

Setelah diubah ke hex mari kita ubah ke ascii, menjadi :
"Terima kasih ron Rivest, adi Shamir dan len Adleman.
SlashRootCTF{rsa_RSA_1254_Rivest-Shamir-Adleman}"

Flag : SlashRootCTF{rsa_RSA_1254_Rivest-Shamir-Adleman}

